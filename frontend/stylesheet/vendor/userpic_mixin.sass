@import colors

@function lightness_color ($background_color)
  @if (lightness($background_color) > 49)
    @return $black
  @else
    @return $white


@mixin userpic ($size)
  $popup_width: 232px
  $popup_height: 312px
  $padding: 10px
  $extra_padding: 8px

  .avatar_wrapper
    width: $size
    height: $size
    border-radius: 50%
    overflow: hidden
    margin: 0 auto
    > img
      object-fit: cover
      width: 100%
      height: 100%


  .no_avatar
    width: $size
    height: $size
    color: $black
    line-height: $size
    text-align: center
    vertical-align: middle
    font-size: ceil($size / 2) - 1
    font-weight: 500
    border: 1px solid $black_transparent_rgba_01
    border-radius: 50%
    @for $i from 1 through length($bgs)
      &.bg_#{$i}
        background-color: nth($bgs, $i)
        color: lightness_color(nth($bgs, $i))
    
  .userpic_wrapper
    display: flex

    .username_date
      display: flex
      flex-direction: column
      justify-content: center
      margin-left: 8px

      .date-text
        font-size: 10px
        text-overflow: ellipsis
        overflow: hidden
        white-space: nowrap
        color: $black_transparent_rgba_04

        &:empty
          display: none

      .nickname
        color: $black
        text-transform: uppercase
        font-size: 12px
        text-overflow: ellipsis
        overflow: hidden
        white-space: nowrap
        //align-self: center

  .userpic.left
    > .profile_wrapper
      padding-right: $padding + $extra_padding
      left: -($popup_width + $padding * 2)
      transform: translateX(-8px)
      > .profile
        &:after
          right: -8px

  .userpic.right
    > .profile_wrapper
      padding-left: $padding + $extra_padding
      right: -($popup_width + $padding * 2) - $extra_padding
      transform: translateX(8px)
      > .profile
        &:after
          left: -8px
          background: url("/images/user-dialogue-pin-left-9x20.svg") no-repeat

  .userpic
    position: relative
    display: flex
    color: $black
    &:hover, &:target
      > .profile_wrapper
        transform: translateX(0px)
        opacity: 1
        transition: all 0.15s ease-out
        visibility: visible
    > a
      display: block
      width: $size
      height: $size
      

    > .profile_wrapper
      padding: 10px
      //animation: userpic_show_left_out 0.15s ease-out
      //display: none
      opacity: 0
      transition: all 0.15s ease-out
      visibility: hidden
      z-index: 2
      position: absolute
      background: transparent
      width: $popup_width + $padding * 2 + $extra_padding
      height: $popup_height + $padding * 2
      top: -($popup_height + $padding * 2) / 2 + 6px
        

      > .profile
        width: 232px
        height: 312px
        border: 1px solid $black_transparent_rgba_01
        border-radius: 4px
        padding: 16px 16px 24px 16px
        background-color: $white
        display: flex
        flex-direction: column
        position: relative
        &:after
          content: ""
          display: block
          position: absolute
          height: 20px
          width: 9px
          top: 50%
          background: url("/images/user-dialogue-pin-right-9x20.svg") no-repeat


        .status_userpic
          display: flex
          .status
            color: $black_transparent_rgba_04
            font-size: 14px
            font-weight: 300
            align-self: flex-start
            width: 50px
            &.offline
              color: $black_transparent_rgba_01


          > .userpic_inner
            flex-grow: 2
            align-self: flex-end
            text-align: center

            .avatar_wrapper
              width: 60px
              height: 60px
              border-radius: 50%
              overflow: hidden
              margin: 0 auto
              > img
                max-width: 60px
                margin: 0 auto
                display: block

            .no_avatar
              width: 60px
              height: 60px
              color: $black
              line-height: 60px
              text-align: center
              vertical-align: middle
              font-size: 29px
              font-weight: 500
              border: 1px solid $black_transparent_rgba_01
              border-radius: 50%
              margin: 0 auto
              @for $i from 1 through length($bgs)
                &.bg_#{$i}
                  background-color: nth($bgs, $i)
                  color: lightness_color(nth($bgs, $i))


          .billing_type_wrapper
            width: 50px
            text-align: right
            .billing_type
              text-transform: uppercase
              font-size: 11px
              align-self: flex-start
              display: inline-block
              padding: 3px 6px
              border-radius: 9px
              &.pro
                color: $white
                background-color: $orange

        .username
          margin-top: 16px
          text-transform: uppercase
          text-align: center
          font-size: 14px
          overflow: hidden
          text-overflow: ellipsis
          white-space: nowrap

        .full_name
          text-align: center
          font-size: 14px
          margin-top: 8px
          overflow: hidden
          text-overflow: ellipsis
          white-space: nowrap

        .projects_notes
          margin-top: 16px
          display: flex

          .projects
            padding-right: 16px
            border-right: 1px solid $black_transparent_rgba_01
            width: calc(50% - 1px)
            text-align: right
            overflow: hidden
            text-overflow: ellipsis
            white-space: nowrap
            color: $black_transparent_rgba_04
          .notes
            padding-left: 17px
            width: calc(50% - 1px)
            text-align: left
            overflow: hidden
            text-overflow: ellipsis
            white-space: nowrap
            color: $black_transparent_rgba_04

        .social
          display: flex
          margin-top: 16px
          justify-content: center
          > a
            display: block
            width: 40px
            height: 40px
            margin-right: 8px
            position: relative
            &:last-child
              margin-right: 0
            &:hover
              > div:first-child
                animation: ripple 0.2s ease-out
                opacity: 1
              > div:last-child
                border: 0

            &.github
              > div:last-child
                background: url("/images/Nots_28_Github.svg") no-repeat
            &.facebook
              > div:last-child
                background: url("/images/Nots_48_Social_facebook.svg") no-repeat
            &.twitter
              > div:last-child
                background: url("/images/Nots_48_Social_twitter.svg") no-repeat
            &.google
              > div:last-child
                background: url("/images/Nots_48_Social_google.svg") no-repeat

            > div
              width: 100%
              height: 100%
              position: absolute
              &:last-child
                background-size: 40px 40px
                border: 1px solid $black_transparent_rgba_01
                border-radius: 50%
                top: 0
                left: 0
                right: 0
                bottom: 0

              &:first-child
                border-radius: 50%
                border: 1px solid transparent
                transform: translate(-50%, -50%)
                opacity: 0
                top: 50%
                left: 50%
                background-color: $button_bg_1
        
        .message_button
          margin-top: 16px
          color: white
          flex-grow: 2
          position: relative
          
          button
            width: 100%
            padding-left: 24px

            &::before
              display: block
              content: ""
              position: absolute
              z-index: 1
              width: 40px
              height: 40px
              left: 32px
              top: 50%
              transform: translate(0, -50%)
              background: url("/images/Nots_48_Messages.svg") no-repeat
              background-size: 40px 40px



